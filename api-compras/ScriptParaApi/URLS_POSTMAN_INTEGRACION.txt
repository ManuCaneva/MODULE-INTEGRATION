â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•
  GUÃA PARA CREAR COLECCIÃ“N DE POSTMAN - PRUEBAS DE INTEGRACIÃ“N
  Compras API â†” Stock API â†” LogÃ­stica API
â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•

ğŸ¯ OBJETIVO: Probar que tus endpoints de Compras llamen correctamente a Stock y LogÃ­stica

ğŸ“š PASOS PREVIOS:
â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€
1. Crear una COLECCIÃ“N en Postman llamada: "Pruebas IntegraciÃ³n Compras"
2. Crear un ENVIRONMENT llamado: "Compras-integracion Local"
3. En el environment, agregar estas VARIABLES:

  BASE_URL_COMPRAS = http://localhost/compras/api
  BASE_URL_STOCK = http://localhost/stock/api/v1
  BASE_URL_LOGISTICA = http://localhost/logistica
  TOKEN = (vacÃ­o - se llenarÃ¡ automÃ¡ticamente)
  PRODUCT_ID = (vacÃ­o - se llenarÃ¡ automÃ¡ticamente)
  PEDIDO_ID = (vacÃ­o - se llenarÃ¡ automÃ¡ticamente)

4. Activar el environment (dropdown arriba a la derecha)
5. Agregar las siguientes requests a la colecciÃ³n:


â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•
  REQUEST #1: Get Token Keycloak
â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•

ğŸ“Œ Nombre de la request: "1. Get Token Keycloak"
ğŸ“Œ DescripciÃ³n: "Obtiene token de autenticaciÃ³n OAuth2 para las siguientes requests"

MÃ©todo: POST

URL:
  http://localhost:8080/realms/ds-2025-realm/protocol/openid-connect/token

Headers:
  (ninguno adicional, Content-Type se agrega automÃ¡ticamente)

Body â†’ Seleccionar: x-www-form-urlencoded
  Agregar estos campos:
  â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
  â”‚ Key              â”‚ Value                                         â”‚
  â”œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¼â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¤
  â”‚ grant_type       â”‚ password                                      â”‚
  â”‚ client_id        â”‚ grupo-04                                      â”‚
  â”‚ client_secret    â”‚ 6be1bec1-9472-499f-ab37-883d78f57829          â”‚
  â”‚ username         â”‚ usuario_test                                  â”‚
  â”‚ password         â”‚ password123                                   â”‚
  â”‚ scope            â”‚ productos:read                                â”‚
  â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”´â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜

Tests â†’ Pegar este cÃ³digo JavaScript:
  â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
  â”‚ var jsonData = pm.response.json();                              â”‚
  â”‚ pm.environment.set("TOKEN", jsonData.access_token);             â”‚
  â”‚                                                                 â”‚
  â”‚ pm.test("âœ… Token obtenido", function () {                      â”‚
  â”‚     pm.response.to.have.status(200);                            â”‚
  â”‚     pm.expect(jsonData.access_token).to.be.a('string');         â”‚
  â”‚ });                                                             â”‚
  â”‚                                                                 â”‚
  â”‚ console.log("âœ… Token guardado:", jsonData.access_token         â”‚
  â”‚             .substring(0, 30) + "...");                         â”‚
  â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜

Resultado esperado:
  âœ… Status: 200 OK
  âœ… Body contiene: { "access_token": "eyJhbGc...", ... }
  âœ… Variable TOKEN se guarda automÃ¡ticamente en el environment


â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•
  REQUEST #2: Listar Productos de Stock API
â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•

ğŸ“Œ Nombre: "2. Listar Productos Stock (obtener PRODUCT_ID)"
ğŸ“Œ DescripciÃ³n: "Obtiene productos reales de Stock API y guarda el primer ID"

MÃ©todo: GET

URL:
  {{BASE_URL_STOCK}}/productos/

Query Params:
  â”Œâ”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”€â”€â”
  â”‚ Key  â”‚ Value  â”‚
  â”œâ”€â”€â”€â”€â”€â”€â”¼â”€â”€â”€â”€â”€â”€â”€â”€â”¤
  â”‚ page â”‚ 1      â”‚
  â”‚ limitâ”‚ 10     â”‚
  â””â”€â”€â”€â”€â”€â”€â”´â”€â”€â”€â”€â”€â”€â”€â”€â”˜

Headers:
  â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
  â”‚ Key             â”‚ Value                 â”‚
  â”œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¼â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¤
  â”‚ Authorization   â”‚ Bearer {{TOKEN}}      â”‚
  â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”´â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜

Body:
  (ninguno)

Tests â†’ Pegar este cÃ³digo:
  â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
  â”‚ var jsonData = pm.response.json();                              â”‚
  â”‚                                                                 â”‚
  â”‚ pm.test("âœ… Stock API responde", function () {                  â”‚
  â”‚     pm.response.to.have.status(200);                            â”‚
  â”‚ });                                                             â”‚
  â”‚                                                                 â”‚
  â”‚ pm.test("âœ… Hay productos disponibles", function () {           â”‚
  â”‚     pm.expect(jsonData.data).to.be.an('array');                 â”‚
  â”‚     pm.expect(jsonData.data.length).to.be.above(0);             â”‚
  â”‚ });                                                             â”‚
  â”‚                                                                 â”‚
  â”‚ pm.test("âœ… NO son datos mock", function () {                   â”‚
  â”‚     pm.expect(jsonData.data[0].nombre).to.not.include("Mock");  â”‚
  â”‚ });                                                             â”‚
  â”‚                                                                 â”‚
  â”‚ // Guardar ID del primer producto                              â”‚
  â”‚ if (jsonData.data && jsonData.data.length > 0) {                â”‚
  â”‚     pm.environment.set("PRODUCT_ID", jsonData.data[0].id);      â”‚
  â”‚     console.log("âœ… Producto guardado:", jsonData.data[0].id,   â”‚
  â”‚                 "-", jsonData.data[0].nombre);                  â”‚
  â”‚ }                                                               â”‚
  â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜

Resultado esperado:
  âœ… Status: 200 OK
  âœ… Body: { "data": [{ "id": "abc-123", "nombre": "...", ... }] }
  âœ… Variable PRODUCT_ID guardada automÃ¡ticamente

ğŸ” VERIFICACIÃ“N DE INTEGRACIÃ“N:
  En PowerShell, ejecuta:
    docker-compose logs stock-backend | Select-String "GET /api/v1/productos"
  
  DeberÃ­as ver logs del Stock API recibiendo la peticiÃ³n.


â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•
  REQUEST #3: Agregar Producto al Carrito (INTEGRACIÃ“N CON STOCK)
â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•

ğŸ“Œ Nombre: "3. Agregar al Carrito (valida con Stock API)"
ğŸ“Œ DescripciÃ³n: "Tu API de Compras debe llamar a Stock para validar el producto"

MÃ©todo: POST

URL:
  {{BASE_URL_COMPRAS}}/shopcart/

Headers:
  â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
  â”‚ Key             â”‚ Value                 â”‚
  â”œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¼â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¤
  â”‚ Authorization   â”‚ Bearer {{TOKEN}}      â”‚
  â”‚ Content-Type    â”‚ application/json      â”‚
  â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”´â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜

Body â†’ Seleccionar: raw (JSON)
  â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
  â”‚ {                                                               â”‚
  â”‚   "productId": "{{PRODUCT_ID}}",                                â”‚
  â”‚   "cantidad": 2                                                 â”‚
  â”‚ }                                                               â”‚
  â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜

Tests:
  â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
  â”‚ var jsonData = pm.response.json();                              â”‚
  â”‚                                                                 â”‚
  â”‚ pm.test("âœ… Producto agregado al carrito", function () {        â”‚
  â”‚     pm.response.to.have.status(201);                            â”‚
  â”‚     pm.expect(jsonData.items).to.be.an('array');                â”‚
  â”‚ });                                                             â”‚
  â”‚                                                                 â”‚
  â”‚ pm.test("âœ… Item tiene info de Stock API", function () {        â”‚
  â”‚     pm.expect(jsonData.items[0].product).to.not.be.null;        â”‚
  â”‚     pm.expect(jsonData.items[0].product.nombre).to.exist;       â”‚
  â”‚ });                                                             â”‚
  â”‚                                                                 â”‚
  â”‚ console.log("âœ… Items en carrito:", jsonData.items.length);     â”‚
  â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜

Resultado esperado:
  âœ… Status: 201 Created
  âœ… Body: { "items": [{ "product": {...}, "cantidad": 2 }], ... }

ğŸ” VERIFICACIÃ“N DE INTEGRACIÃ“N (Â¡IMPORTANTE!):
  En PowerShell, ejecuta MIENTRAS haces la request:
    docker-compose logs -f django | Select-String "StockClient"
  
  DeberÃ­as ver:
    [StockClient] GET http://nginx/stock/api/v1/productos/{{PRODUCT_ID}}
    [StockClient] Response 200: {"nombre": "...", "precio": 1500}
  
  Esto CONFIRMA que tu API de Compras llamÃ³ a Stock API âœ…


â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•
  REQUEST #4: Ver Carrito (con datos de Stock)
â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•

ğŸ“Œ Nombre: "4. Ver Carrito"

MÃ©todo: GET
URL: {{BASE_URL_COMPRAS}}/shopcart/
Headers: Authorization: Bearer {{TOKEN}}

Tests:
  var jsonData = pm.response.json();
  pm.test("âœ… Carrito tiene items", function () {
      pm.expect(jsonData.items.length).to.be.above(0);
  });
  pm.test("âœ… Items tienen info de producto (no null)", function () {
      jsonData.items.forEach(function(item) {
          pm.expect(item.product).to.not.be.null;
      });
  });

Resultado esperado:
  âœ… Status: 200 OK
  âœ… Items con informaciÃ³n completa del producto


â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•
  REQUEST #5: Crear Pedido desde Carrito (RESERVA EN STOCK API)
â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•

ğŸ“Œ Nombre: "5. Crear Pedido / Checkout (reserva stock)"
ğŸ“Œ DescripciÃ³n: "Tu API debe llamar a Stock API para reservar los productos"

MÃ©todo: POST
URL: {{BASE_URL_COMPRAS}}/pedidos/desde-carrito/
Headers: Authorization: Bearer {{TOKEN}}
Body: (ninguno - lee del carrito automÃ¡ticamente)

Tests:
  var jsonData = pm.response.json();
  
  pm.test("âœ… Pedido creado", function () {
      pm.response.to.have.status(201);
      pm.expect(jsonData.id).to.be.a('number');
  });
  
  pm.test("âœ… Tiene ID de reserva de Stock", function () {
      pm.expect(jsonData.reservaId || jsonData.stock_reserva_id).to.exist;
  });
  
  // Guardar ID del pedido para siguiente request
  if (jsonData.id) {
      pm.environment.set("PEDIDO_ID", jsonData.id);
      console.log("âœ… Pedido creado con ID:", jsonData.id);
  }

Resultado esperado:
  âœ… Status: 201 Created
  âœ… Body: { "id": 5, "reservaId": "res-789", "estado": "pendiente", ... }
  âœ… Variable PEDIDO_ID guardada

ğŸ” VERIFICACIÃ“N DE INTEGRACIÃ“N:
  docker-compose logs django | Select-String "reservar_stock"
  docker-compose logs stock-backend | Select-String "POST /api/v1/reservas"
  
  Esto confirma que se reservÃ³ stock en Stock API âœ…


â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•
  REQUEST #6: Confirmar Pedido (CREA ENVÃO EN LOGÃSTICA API)
â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•

ğŸ“Œ Nombre: "6. Confirmar Pedido (crea envÃ­o en LogÃ­stica)"
ğŸ“Œ DescripciÃ³n: "Tu API debe llamar a LogÃ­stica para crear el envÃ­o"

MÃ©todo: POST
URL: {{BASE_URL_COMPRAS}}/pedidos/{{PEDIDO_ID}}/confirmar/
Headers: Authorization: Bearer {{TOKEN}}

Tests:
  pm.test("âœ… Pedido confirmado o LogÃ­stica no disponible", function () {
      // 200/201 = OK, 502 = LogÃ­stica no disponible (normal)
      pm.expect([200, 201, 502]).to.include(pm.response.code);
  });
  
  if (pm.response.code === 200 || pm.response.code === 201) {
      var jsonData = pm.response.json();
      pm.test("âœ… Tiene ID de envÃ­o de LogÃ­stica", function () {
          pm.expect(jsonData.envioId || jsonData.shippingId).to.exist;
      });
      console.log("âœ… EnvÃ­o creado con ID:", jsonData.envioId);
  } else if (pm.response.code === 502) {
      console.log("âš ï¸  LogÃ­stica API no disponible (502 Bad Gateway)");
  }

Resultado esperado:
  âœ… Status: 200 OK (si LogÃ­stica estÃ¡ activa)
  âš ï¸  Status: 502 Bad Gateway (si LogÃ­stica NO estÃ¡ activa - es normal)

ğŸ” VERIFICACIÃ“N DE INTEGRACIÃ“N:
  docker-compose logs django | Select-String "LogisticaClient"
  docker-compose logs shipping-back | Select-String "POST"


â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•
  REQUEST #7: Historial de Pedidos
â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•

ğŸ“Œ Nombre: "7. Historial de Pedidos"

MÃ©todo: GET
URL: {{BASE_URL_COMPRAS}}/pedidos/
Headers: Authorization: Bearer {{TOKEN}}

Tests:
  var jsonData = pm.response.json();
  var pedidos = Array.isArray(jsonData) ? jsonData : jsonData.results;
  
  pm.test("âœ… Tiene pedidos", function () {
      pm.expect(pedidos.length).to.be.above(0);
  });
  
  console.log("ï¿½ Total de pedidos:", pedidos.length);

Resultado esperado:
  âœ… Status: 200 OK
  âœ… Lista de pedidos


â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•
  REQUEST #8: Limpiar Carrito (para nuevas pruebas)
â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•

ğŸ“Œ Nombre: "8. Limpiar Carrito"

MÃ©todo: DELETE
URL: {{BASE_URL_COMPRAS}}/shopcart/clear/
Headers: Authorization: Bearer {{TOKEN}}

Tests:
  pm.test("âœ… Carrito vaciado", function () {
      pm.response.to.have.status(204);
  });

Resultado esperado:
  âœ… Status: 204 No Content


â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•
  ğŸ“Š RESUMEN: ORDEN DE EJECUCIÃ“N DE LAS REQUESTS
â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•

  1. Get Token Keycloak          â†’ Guarda TOKEN
  2. Listar Productos Stock      â†’ Guarda PRODUCT_ID
  3. Agregar al Carrito          â†’ Usa TOKEN y PRODUCT_ID, llama a Stock
  4. Ver Carrito                 â†’ Verifica datos de Stock
  5. Crear Pedido (Checkout)     â†’ Guarda PEDIDO_ID, reserva en Stock
  6. Confirmar Pedido            â†’ Usa PEDIDO_ID, crea envÃ­o en LogÃ­stica
  7. Historial de Pedidos        â†’ Verifica que el pedido aparezca
  8. Limpiar Carrito             â†’ Para empezar de nuevo

âœ… PUNTOS CLAVE DE VERIFICACIÃ“N:
  â€¢ Request #3: Ver logs de StockClient (valida producto)
  â€¢ Request #5: Ver logs de reservar_stock (reserva en Stock)
  â€¢ Request #6: Ver logs de LogisticaClient (crea envÃ­o)

â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•
  ğŸ“Š ENDPOINTS ADICIONALES - STOCK API (solo consulta)
â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•

ğŸ”¹ Listar categorÃ­as:
   GET http://localhost/stock/api/v1/categorias
   Headers: Authorization: Bearer {{TOKEN}}

ğŸ”¹ Detalle de categorÃ­a:
   GET http://localhost/stock/api/v1/categorias/{id}
   Headers: Authorization: Bearer {{TOKEN}}

ğŸ”¹ Listar reservas del usuario:
   GET http://localhost/stock/api/v1/reservas?usuarioId=123&page=1&limit=10
   Headers: Authorization: Bearer {{TOKEN}}

ğŸ”¹ Detalle de una reserva:
   GET http://localhost/stock/api/v1/reservas/{id}?usuarioId=123
   Headers: Authorization: Bearer {{TOKEN}}


â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•
  ğŸ“Š ENDPOINTS ADICIONALES - LOGÃSTICA API (solo consulta)
â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•

ğŸ”¹ Calcular costo de envÃ­o:
   POST http://localhost/logistica/shipping/cost
   Headers: Authorization: Bearer {{TOKEN}}
   Body: {
     "delivery_address": {
       "street": "Av. Libertador 1234",
       "city": "Resistencia",
       "state": "Chaco",
       "postal_code": "3500",
       "country": "Argentina"
     },
     "products": [{"id": 1, "quantity": 2}],
     "transport_type": "road"
   }

ğŸ”¹ MÃ©todos de transporte disponibles:
   GET http://localhost/logistica/shipping/transport-methods
   Headers: Authorization: Bearer {{TOKEN}}

ğŸ”¹ Listar envÃ­os del usuario:
   GET http://localhost/logistica/shipping?user_id=123&page=1&limit=10
   Headers: Authorization: Bearer {{TOKEN}}

ğŸ”¹ Detalle de un envÃ­o:
   GET http://localhost/logistica/shipping/{id}
   Headers: Authorization: Bearer {{TOKEN}}

ğŸ”¹ Cancelar un envÃ­o:
   POST http://localhost/logistica/shipping/{id}/cancel
   Headers: Authorization: Bearer {{TOKEN}}


â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•
  ğŸ” VERIFICACIÃ“N DE LOGS - COMANDOS ÃšTILES
â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•

ğŸ“ Ver llamadas a Stock API desde Django:
   docker-compose logs django | Select-String "StockClient"

ğŸ“ Ver llamadas a LogÃ­stica API desde Django:
   docker-compose logs django | Select-String "LogisticaClient"

ğŸ“ Ver logs completos de Stock API:
   docker-compose logs -f stock-backend

ğŸ“ Ver logs completos de LogÃ­stica API:
   docker-compose logs -f shipping-back

ğŸ“ Ver logs de Django (errores):
   docker-compose logs -f django

ğŸ“ Ver logs de Nginx (routing):
   docker-compose logs -f nginx


â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•
  âœ… CHECKLIST DE PRUEBAS DE INTEGRACIÃ“N
â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•

â–¡ 1. Obtener token de Keycloak
â–¡ 2. Listar productos de Stock API (NO mock)
â–¡ 3. Obtener detalle de producto de Stock
â–¡ 4. Agregar producto al carrito (ver logs: llama a Stock)
â–¡ 5. Ver carrito (productos tienen info de Stock, no null)
â–¡ 6. Crear pedido desde carrito (ver logs: llama a reservar_stock)
â–¡ 7. Verificar que pedido tiene reservaId
â–¡ 8. Confirmar pedido (ver logs: llama a LogÃ­stica)
â–¡ 9. Verificar que pedido tiene envioId (si LogÃ­stica estÃ¡ activa)
â–¡ 10. Ver historial de pedidos

EVIDENCIAS A RECOLECTAR:
â–¡ Screenshots de Postman con respuestas 200/201 OK
â–¡ Captura de logs mostrando llamadas a Stock (StockClient)
â–¡ Captura de logs mostrando llamadas a LogÃ­stica (LogisticaClient)
â–¡ Screenshot de pedido con reservaId de Stock
â–¡ Screenshot de pedido con envioId de LogÃ­stica


â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•
  ğŸ“ NOTAS IMPORTANTES
â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•

âš ï¸  USE_MOCK_APIS debe estar en "false" en docker-compose.yml
âš ï¸  Todos los servicios deben estar UP (docker-compose ps)
âš ï¸  El error 502 en /confirmar/ es NORMAL si LogÃ­stica no estÃ¡ disponible
âš ï¸  Siempre usar IDs reales obtenidos de Stock API (paso 3)
âš ï¸  El token expira, renovarlo si obtienes 401 Unauthorized
âš ï¸  Los logs son la evidencia principal de integraciÃ³n

â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•
